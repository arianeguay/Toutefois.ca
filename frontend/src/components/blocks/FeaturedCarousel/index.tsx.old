import { useEffect, useState } from 'react';
import 'swiper/css';
import 'swiper/css/navigation';
import 'swiper/css/pagination';
import Api from '../../../api';
import type { WordpressProject } from '../../../types';
import FeaturedSlide from './FeaturedSlide';
import useCarouselTimer from './hooks/useCarouselTimer';
import { CarouselContainer } from './styles';
const FeaturedCarousel = () => {
  const [projects, setProjects] = useState<WordpressProject[]>([]);
  const [loading, setLoading] = useState(true);
  const { slideIndex, startTimer, stopTimer } = useCarouselTimer(
    projects.length,
  );

  const images = useEffect(() => {
    const getProjects = async () => {
      try {
        const data = await Api.fetchFeaturedProjects();
        setProjects(data);
      } catch (error) {
        console.error('Failed to fetch featured projects:', error);
      } finally {
        setLoading(false);
      }
    };

    getProjects();
  }, []);

  if (loading) return null;
  if (!projects?.length) return null;

  return (
    <CarouselContainer onMouseEnter={stopTimer} onMouseLeave={startTimer}>
      {projects.map((project, index) => (
        <FeaturedSlide
          key={project.id}
          project={project}
          isCurrent={index === slideIndex}
        />
      ))}
    </CarouselContainer>
  );
};

export default FeaturedCarousel;
