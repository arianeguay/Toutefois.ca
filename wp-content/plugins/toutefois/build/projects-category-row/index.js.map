{"version":3,"file":"projects-category-row/index.js","mappings":"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","sources":["webpack://toutefois-blocks/./src/projects-category-row/edit.js","webpack://toutefois-blocks/./src/projects-category-row/save.js","webpack://toutefois-blocks/external window [\"wp\",\"blockEditor\"]","webpack://toutefois-blocks/external window [\"wp\",\"blocks\"]","webpack://toutefois-blocks/external window [\"wp\",\"components\"]","webpack://toutefois-blocks/external window [\"wp\",\"data\"]","webpack://toutefois-blocks/external window [\"wp\",\"element\"]","webpack://toutefois-blocks/external window [\"wp\",\"i18n\"]","webpack://toutefois-blocks/external window \"React\"","webpack://toutefois-blocks/webpack/bootstrap","webpack://toutefois-blocks/webpack/runtime/compat get default export","webpack://toutefois-blocks/webpack/runtime/define property getters","webpack://toutefois-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://toutefois-blocks/webpack/runtime/make namespace object","webpack://toutefois-blocks/./src/projects-category-row/index.js"],"sourcesContent":["import { InspectorControls } from \"@wordpress/block-editor\";\nimport {\n  Notice,\n  PanelBody,\n  SelectControl,\n  Spinner,\n} from \"@wordpress/components\";\nimport { useSelect } from \"@wordpress/data\";\nimport { useMemo } from \"@wordpress/element\";\nimport { __ } from \"@wordpress/i18n\";\n\n// --- CONFIG ---\n// If you use the default \"Categories\", keep TAXONOMY = 'category' and TAX_REST_BASE = 'categories'.\n// For a custom taxonomy (e.g. 'project_category'), set TAXONOMY = 'project_category' and TAX_REST_BASE = 'project_category'.\nconst CPT_SLUG = \"projet\"; // your CPT slug (post_type)\nconst TAXONOMY = \"category\"; // or 'project_category'\nconst TAX_REST_BASE =\n  TAXONOMY === \"category\" ? \"categories\" : \"project_category\";\nconst PREVIEW_LIMIT = 6;\n\nexport default function Edit({ attributes, setAttributes }) {\n  const {\n    category /* storing ID is better; if you already store slug, see note below */,\n  } = attributes;\n\n  // Load taxonomy terms\n  const terms = useSelect(\n    (select) =>\n      select(\"core\").getEntityRecords(\"taxonomy\", TAXONOMY, { per_page: -1 }),\n    []\n  );\n\n  // Coerce value to a number if you store IDs as strings\n  const categoryId = useMemo(() => {\n    if (!category) return null;\n    const n = Number(category);\n    return Number.isFinite(n) && n > 0 ? n : null;\n  }, [category]);\n\n  // Build query for CPT, filtered by taxonomy (IDs)\n  const cptQuery = useMemo(() => {\n    const q = { per_page: PREVIEW_LIMIT, _embed: true };\n    if (categoryId) {\n      // Filter by taxonomy. For default categories use 'categories', for custom use its rest_base.\n      q[TAX_REST_BASE] = [categoryId];\n    }\n    return q;\n  }, [categoryId]);\n\n  // Fetch CPT posts\n  const posts = useSelect(\n    (select) => select(\"core\").getEntityRecords(\"postType\", CPT_SLUG, cptQuery),\n    [cptQuery]\n  );\n\n  // Build select options\n  const options = useMemo(() => {\n    const base = [{ label: __(\"All\", \"toutefois\"), value: \"\" }];\n    if (!terms) return base;\n    return base.concat(\n      terms.map((t) => ({\n        label: t.name,\n        value: String(t.id), // store ID as string in attributes\n      }))\n    );\n  }, [terms]);\n\n  // Helpers to read featured media from _embed\n  const getThumb = (post) => {\n    const media =\n      post?._embedded?.[\"wp:featuredmedia\"]?.[0]?.media_details?.sizes\n        ?.medium ||\n      post?._embedded?.[\"wp:featuredmedia\"]?.[0]?.media_details?.sizes\n        ?.thumbnail;\n    return media ? media.source_url : null;\n  };\n\n  return (\n    <>\n      <InspectorControls>\n        <PanelBody title={__(\"Projects Row Settings\", \"toutefois\")}>\n          <SelectControl\n            label={__(\"Category\", \"toutefois\")}\n            value={category || \"\"}\n            options={options}\n            onChange={(val) => setAttributes({ category: val })}\n            help={\n              TAXONOMY === \"category\"\n                ? __(\"Filters by WordPress “Categories”.\", \"toutefois\")\n                : __(\"Filters by custom taxonomy.\", \"toutefois\")\n            }\n          />\n        </PanelBody>\n      </InspectorControls>\n\n      {/* Editor Preview */}\n      <div\n        className=\"toutefois-projects-row__preview\"\n        style={{\n          display: \"grid\",\n          gap: \"12px\",\n          gridTemplateColumns: \"repeat(auto-fill, minmax(180px, 1fr))\",\n        }}\n      >\n        {!terms && <Spinner />}\n\n        {terms && posts === undefined && (\n          <div style={{ gridColumn: \"1 / -1\" }}>\n            <Spinner />\n          </div>\n        )}\n\n        {terms && posts && posts.length === 0 && (\n          <Notice status=\"info\" isDismissible={false}>\n            {__(\"No projects found for this selection.\", \"toutefois\")}\n          </Notice>\n        )}\n\n        {!!posts\n          ? posts.map((p) => {\n              const thumb = getThumb(p);\n              return (\n                <div\n                  key={p.id}\n                  style={{\n                    border: \"1px solid #ddd\",\n                    borderRadius: 8,\n                    overflow: \"hidden\",\n                    background: \"#fff\",\n                  }}\n                >\n                  {thumb ? (\n                    <img\n                      src={thumb}\n                      alt=\"\"\n                      style={{\n                        width: \"100%\",\n                        display: \"block\",\n                        aspectRatio: \"16 / 9\",\n                        objectFit: \"cover\",\n                      }}\n                    />\n                  ) : (\n                    <div\n                      style={{\n                        background: \"#f2f2f2\",\n                        width: \"100%\",\n                        aspectRatio: \"16 / 9\",\n                      }}\n                    />\n                  )}\n                  <div style={{ padding: 10 }}>\n                    <strong style={{ display: \"block\", marginBottom: 6 }}>\n                      {p.title?.rendered || __(\"(No title)\", \"toutefois\")}\n                    </strong>\n                    {/* Optional: small taxonomy badges */}\n                    {/* <small style={{ opacity: 0.7 }}>{/* badges here */}\n                    {/*}</small> */}\n                  </div>\n                </div>\n              );\n            })\n          : \"No projects found\"}\n      </div>\n    </>\n  );\n}\n","export default function save() {\n    return null; // Content is rendered dynamically via PHP.\n}\n","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"React\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBlockType } from '@wordpress/blocks';\nimport Edit from './edit';\nimport save from './save';\nimport metadata from './block.json';\n\nregisterBlockType(metadata.name, {\n    edit: Edit,\n    save,\n});\n"],"names":["InspectorControls","Notice","PanelBody","SelectControl","Spinner","useSelect","useMemo","__","CPT_SLUG","TAXONOMY","TAX_REST_BASE","PREVIEW_LIMIT","Edit","attributes","setAttributes","category","terms","select","getEntityRecords","per_page","categoryId","n","Number","isFinite","cptQuery","q","_embed","posts","options","base","label","value","concat","map","t","name","String","id","getThumb","post","media","_embedded","media_details","sizes","medium","thumbnail","source_url","createElement","Fragment","title","onChange","val","help","className","style","display","gap","gridTemplateColumns","undefined","gridColumn","length","status","isDismissible","p","thumb","key","border","borderRadius","overflow","background","src","alt","width","aspectRatio","objectFit","padding","marginBottom","rendered","save","registerBlockType","metadata","edit"],"sourceRoot":""}